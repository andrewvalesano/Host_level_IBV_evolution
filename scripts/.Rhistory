p <- 0.95
N <- 100
var <- N*p*(1-p)
iterations <- seq(1, 1000, by=1)
results <- c()
for(i in iterations)
{
r <- tube_test(p, N)
results <- c(results, r)
}
hist(results, main="Distribution of Days Until the Day of Reckoning", xlab="Days")
var(results)
library(magrittr)
library(ggplot2)
N <- 1000
a <- 0.25
b <- 0.75
single_Y <- function(N = 1000, a = 0.25, b = 0.75)
{
Xi <- runif(n=1000, 0, 1)
Y <- length(Xi[Xi > a & Xi < b])
return(Y)
}
Y_vector <- c()
for(i in seq(1, 1000))
{
Y <- single_Y(N = 1000, a = 0.25, b = 0.75)
Y_vector <- c(Y_vector, Y)
}
Pois_sim <- rpois(n = N, lambda = N*(b-a))
Pois_distribution <- dpois(x=N, lambda = N*(b-a))
data.frame(y=Y_vector, p=Pois_sim) -> df
df %>% ggplot() + geom_histogram(aes(x=y),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5)
Pois_distribution
library(manipulate)
library(plyr)
library(magrittr)
library(ggplot2)
manipulate(
{
data.frame(x=seq(0,max.x,by=1)) %>%
mutate(
pdf=dpois(x=x,lambda=lambda),
cdf=ppois(q=x,lambda=lambda)
) %>%
ggplot(aes(x=x))+theme_bw()+
geom_bar(aes(y=pdf),stat='identity',color=NA,fill=gray(0.4))+
expand_limits(x=c(0,max.x))+
labs(y="")+
geom_point(aes(y=cdf),color='red')+
geom_line(aes(y=cdf),color='red')
},
lambda=slider(0,20,init=1,step=0.01,label="lambda"),
max.x=slider(10,100,init=10,step=1,label="max x")
)
Pois_distribution <- dpois(x=N, lambda = N*(b-a))
Pois_distribution
Pois_sim <- rpois(n = N, lambda = N*(b-a))
Pois_distribution <- c()
for(n in seq(0, N, by=1))
{
pois <- dpois(x=N, lambda = N*(b-a))
Pois_distribution <- c(Pois_distribution, pois)
}
data.frame(y=Y_vector, p=Pois_sim) -> df
df %>% ggplot() + geom_histogram(aes(x=y),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5)
Pois_distribution
Pois_sim <- rpois(n = N, lambda = N*(b-a))
Pois_distribution <- c()
for(n in seq(0, N, by=1))
{
pois <- dpois(x=n, lambda = N*(b-a))
Pois_distribution <- c(Pois_distribution, pois)
}
data.frame(y=Y_vector, p=Pois_sim) -> df
df %>% ggplot() + geom_histogram(aes(x=y),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5)
Pois_distribution
Pois_sim <- rpois(n = N, lambda = N*(b-a))
Pois_distribution <- c()
for(n in seq(0, N, by=1))
{
pois <- dpois(x=n, lambda = N*(b-a))
Pois_distribution <- c(Pois_distribution, pois)
}
data.frame(y=Y_vector, p=Pois_sim, pdf=Pois_distribution) -> df
df
tail(df)
length(pdf)
length(Pois_distribution)
Pois_sim <- rpois(n = N, lambda = N*(b-a))
Pois_distribution <- c()
for(n in seq(1, N, by=1))
{
pois <- dpois(x=n, lambda = N*(b-a))
Pois_distribution <- c(Pois_distribution, pois)
}
data.frame(y=Y_vector, p=Pois_sim, pdf=Pois_distribution) -> df
df %>% ggplot() + geom_histogram(aes(x=y),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y, stat="density"),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y, stat="density"),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, stat="density"),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5) #+ geom_bar(aes(y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) #+ geom_bar(aes(y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(x=pdf_x, y=pdf))
Pois_sim <- rpois(n = N, lambda = N*(b-a))
Pois_distribution <- c()
for(n in seq(1, N, by=1))
{
pois <- dpois(x=n, lambda = N*(b-a))
Pois_distribution <- c(Pois_distribution, pois)
}
data.frame(y=Y_vector, p=Pois_sim, pdf=Pois_distribution, pdf_x=seq(1, N, by=1)) -> df
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(x=pdf_x, y=pdf))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) #+ geom_bar(aes(x=pdf_x, y=pdf))
df %>% ggplot() + geom_bar(aes(x=pdf_x, y=pdf))
Pois_distribution
df %>% ggplot() + geom_histogram(aes(x=pdf_x, y=pdf))
df$pdf_x
df$pdf
df %>% ggplot() + geom_bar(aes(x=pdf_x, y=pdf))
df %>% ggplot() + geom_bar(aes(x=pdf_x, y=pdf),stat='identity',color=NA,fill=gray(0.4))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill=gray(0.4))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) #+ geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill=gray(0.4))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + expand_limits(x=c(400,600)) #+ geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill=gray(0.4))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + expand_limits(x=c(400,600)) + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill=gray(0.4))
df %>% ggplot() + geom_bar(aes(x=pdf_x, y=pdf),stat='identity',color=NA,fill=gray(0.4))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + expand_limits(x=c(400,600)) + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill=gray(0.4))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill=gray(0.4)) + expand_limits(x=c(400,600))
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill=gray(0.4)) + xlim(400, 600)
df %>% ggplot() + geom_histogram(aes(x=y),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p),fill="red", color = "black", alpha = 0.5)
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_histogram(aes(x=p, , y=..density..),fill="red", color = "black", alpha = 0.5) + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color="black", fill="red", alpha=0.5) + xlim(400, 600)
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color="black", fill="red", alpha=0.5) + xlim(400, 600)
df %>% ggplot() + geom_histogram(aes(x=y, y=..density..),fill="grey", color = "black", alpha=0.5) + theme_bw() + geom_bar(aes(x=pdf_x, y=pdf), stat='identity', color=NA, fill="red", alpha=0.5) + xlim(400, 600)
install.pacj
install.packages("gamlss")
as.list(coef(fit_power)
)
knitr::opts_chunk$set(echo = TRUE)
options(warn=-1)
library(readr)
library(magrittr)
library(ggplot2)
library(tidyverse)
read_csv("https://kinglab.eeb.lsa.umich.edu/480/data/gophertortoise.csv",
comment="#",col_types=cols(date="D",sex="c",elisa="c")) -> gt
gt
gt1 %>%
mutate(
pred=predict(fit,newdata=gt1),
out.of.fit=(date>"2005-01-01")
) -> gt1
gt %>%
group_by(id) %>%
filter(date==min(date)) %>%
ungroup() -> gt1
gt1
gt1 %>%
mutate(
pred=predict(fit,newdata=gt1),
out.of.fit=(date>"2005-01-01")
) -> gt1
gt1 %>%
mutate(
serostatus=ifelse(elisa=="neg",0,1)
) -> gt1
loglik <- function (p, serostatus) {
sum(dbinom(x=serostatus,size=1,prob=p,log=TRUE))
}
library(bbmle)
expit <- function (x) 1/(1+exp(-x))
nll <- function (a, b, carapace.length, serostatus) {
ll <- loglik(p=expit(a+b*carapace.length),serostatus)
if (is.finite(ll)) -ll else 1e20
}
fit <- mle2(nll,start=list(a=0,b=0),data=gt1)
gt1 %>%
mutate(
pred=predict(fit,newdata=gt1),
out.of.fit=(date>"2005-01-01")
) -> gt1
gt1 %>%
mutate(
pred=predict(fit,newdata=gt1),
out.of.fit=(carapace.length>240)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit,newdata=gt1),
out.of.fit=(carapace.length>240)
) -> gt1
gt1 %>%
mutate(
pred=fitted(fit,newdata=gt1),
out.of.fit=(carapace.length>240)
) -> gt1
gt1 %>%
mutate(
pred=with(as.list(coef(fit)),expit(a+b*carapace.length)),
out.of.fit=(carapace.length>240)
) -> gt1
gt1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw() + geom_line(aes(y=fitted),color='black')
gt1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw() + geom_line(aes(y=pred),color='black')
head(gt1)
t1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw() + geom_line(aes(y=pred),color='black') + facet_grid(~out.of.fit,labeller=label_both)
gt1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw() + geom_line(aes(y=pred),color='black') + facet_grid(~out.of.fit,labeller=label_both)
head(gt1)
gt1 %>%
mutate(
fitted=with(as.list(coef(fit)),expit(a+b*carapace.length))
) -> gt1
gt1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw() + geom_line(aes(y=pred),color='black') + facet_grid(~out.of.fit,labeller=label_both)
gt1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw() + geom_line(aes(y=pred),color='black') + facet_grid(~out.of.fit,labeller=label_both) -> pl
pl
gt1 %>%
mutate(
pred=with(as.list(coef(fit)),expit(a+b*carapace.length)),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw() + geom_line(aes(y=pred),color='black') + facet_grid(~out.of.fit,labeller=label_both) -> pl
pl
gt1 %>%
group_by(out.of.fit) %>%
summarize(
R2=1-sum((fitted-pred)^2)/sum((fitted-mean(fitted))^2)
)
pl
gt1 %>%
mutate(
pred=fitted(fit),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1, type="response"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=fitted(fit),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
ggplot(mapping=aes(x=pred,y=fitted))+
geom_point()+
facet_grid(~out.of.fit,labeller=label_both)+
geom_abline(intercept=0,slope=1)+theme_bw() -> pl2
pl2
gt1 %>%
group_by(out.of.fit) %>%
summarize(
R2=1-sum((fitted-pred)^2)/sum((fitted-mean(fitted))^2)
)
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1, type="response"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
fit
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1, type="response"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1, type="expected"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit, newdata=filter(gt1, out.of.fit==FALSE), type="expected"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1, type="response"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
serostatus=ifelse(elisa=="neg",0,1)
) -> gt1
loglik <- function (p, serostatus) {
sum(dbinom(x=serostatus,size=1,prob=p,log=TRUE))
}
library(bbmle)
expit <- function (x) 1/(1+exp(-x))
nll <- function (a, b, carapace.length, serostatus) {
ll <- loglik(p=expit(a+b*carapace.length),serostatus)
if (is.finite(ll)) -ll else 1e20
}
fit <- mle2(nll,start=list(a=0,b=0),data=gt1)
fit
summary(fit)
gt1 %>%
mutate(
pred=predict.glm(fit, newdata=gt1, type="response"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
library(bbmle)
gt1 %>%
mutate(
pred=predict(fit),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
library(bbmle)
gt1 %>%
mutate(
pred=predict(fit, newdata=gt1),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=bbmle::predict(fit, newdata=gt1),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
library(tidyverse)
library(bbmle)
predict()
bbmle::predict()
gt1 %>%
mutate(
pred=predict(fit),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
predict(fit)
gt %>%
group_by(id) %>%
filter(date==min(date)) %>%
ungroup() -> gt1
gt1
gt1 %>%
mutate(
serostatus=ifelse(elisa=="neg",0,1)
) -> gt1
loglik <- function (p, serostatus) {
sum(dbinom(x=serostatus,size=1,prob=p,log=TRUE))
}
library(bbmle)
expit <- function (x) 1/(1+exp(-x))
nll <- function (a, b, carapace.length, serostatus) {
ll <- loglik(p=expit(a+b*carapace.length),serostatus)
if (is.finite(ll)) -ll else 1e20
}
fit <- mle2(nll,start=list(a=0,b=0),data=gt1)
coef(fit)
logLik(fit)
summary(fit)
fit_profile <- profile(fit)
plot(fit_profile)
confint(fit_profile)
gt1 %>%
mutate(
fitted=with(as.list(coef(fit)),expit(a+b*carapace.length))
) -> gt1
gt1 %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=fitted),color='black') + theme_bw()
predict(fit)
bbmle::predict(fit)
require(bbmle)
predict(fit)
predict(fit)
fitted(fit)
residuals(fit)
gt1 %>%
mutate(
pred=predict(fit, op="predict"),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
predict(fit)
fit
str(fit)
gt1 %>%
mutate(
pred=with(as.list(coef(fit)),expit(a+b*carapace.length)),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1 %>%
mutate(
pred=with(as.list(coef(fit)),expit(a+b*carapace.length)),
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1_fit <- filter(gt1, out.of.fit==FALSE)
gt1_newtest <- filter(gt1, out.of.fit==TRUE)
gt1 %>%
mutate(
out.of.fit=(carapace.length %% 2 == 0)
) -> gt1
gt1_train <- filter(gt1, out.of.fit==FALSE)
gt1_newtest <- filter(gt1, out.of.fit==TRUE)
fit_train <- mle2(nll,start=list(a=0,b=0),data=gt1_train)
fit_newtest <- mle2(nll,start=list(a=0,b=0),data=gt1_newtest)
gt1_newtest %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=with(as.list(coef(fit)),expit(a+b*carapace.length))),color='black') + theme_bw() + geom_line(aes(y=pred),color='black') + facet_grid(~out.of.fit,labeller=label_both) -> pl
pl
gt1_newtest %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=with(as.list(coef(fit_train)),expit(a+b*carapace.length))),color='black') + theme_bw() + geom_line(aes(y=pred),color='black') + facet_grid(~out.of.fit,labeller=label_both) -> pl
pl
gt1_newtest %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=with(as.list(coef(fit_train)),expit(a+b*carapace.length))),color='black') + theme_bw()
gt1_newtest %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=with(as.list(coef(fit_train)),expit(a+b*carapace.length))),color='black') + theme_bw() -> pl
pl
gt1 %>%
mutate(
out.of.fit=(carapace.length %% 2 == 0),
fitted=with(as.list(coef(fit_train)),expit(a+b*carapace.length)),
pred=with(as.list(coef(fit_newtest)),expit(a+b*carapace.length))
) -> gt1
gt1_newtest %>%
ggplot(aes(x=carapace.length))+
geom_jitter(aes(y=serostatus, color=elisa),height=0.05,width=0)+
geom_line(aes(y=with(as.list(coef(fit_train)),expit(a+b*carapace.length))),color='black') + theme_bw() -> pl
pl
pl
gt1 %>%
ggplot(mapping=aes(x=pred,y=fitted))+
geom_point()+
facet_grid(~out.of.fit,labeller=label_both)+
geom_abline(intercept=0,slope=1)+theme_bw() -> pl2
pl2
gt1 %>%
ggplot(mapping=aes(x=pred,y=fitted))+
geom_point()+
geom_abline(intercept=0,slope=1)+theme_bw() -> pl2
pl2
pl2
gt1 %>%
group_by(out.of.fit) %>%
summarize(
R2=1-sum((fitted-pred)^2)/sum((fitted-mean(fitted))^2)
)
pl2
gt1 %>%
group_by(out.of.fit) %>%
summarize(
R2=1-sum((fitted-pred)^2)/sum((fitted-mean(fitted))^2)
)
setwd("/Users/avalesano/Documents/MSTP/LauringLab/Host_level_IBV_evolution/scripts/")
library(tidyverse)
library(magrittr)
library(wesanderson)
library(ggbeeswarm)
palette <- wesanderson::wes_palette("FantasticFox1")
meta <- read_csv("../data/metadata/flu_b_2010_2017_v4LONG_withSeqInfo_gc.csv")
View(meta)
nrow(filter(meta, season == "2010-2011"))
nrow(filter(meta, season == "2011-2012"))
nrow(filter(meta, season == "2012-2013"))
nrow(filter(meta, season == "2013-2014"))
nrow(filter(meta, season == "2014-2015"))
nrow(filter(meta, season == "2015-2016"))
nrow(filter(meta, season == "2016-2017"))
filter(meta, season == "2011-2012")
filter(meta, season == "2011-2012")$pcr_result
filter(meta, season == "2013-2014")$pcr_result
filter(meta, season == "2010-2011")$pcr_result
filter(meta, season == "2012-2013")$pcr_result
filter(meta, season == "2015-2016")$pcr_result
length(filter(meta, season == "2014-2015")$pcr_result == "B/VIC")
filter(meta, season == "2014-2015")$pcr_result == "B/VIC"
nrow(filter(meta, season == "2014-2015" & pcr_result == "B/VIC"))
nrow(filter(meta, season == "2014-2015" & pcr_result == "B/YAM"))
nrow(filter(meta, season == "2016-2017" & pcr_result == "B/VIC"))
nrow(filter(meta, season == "2016-2017" & pcr_result == "B/YAM"))
